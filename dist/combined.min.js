!function(){"use strict";var a=angular.module("ports",["listModule","mapModule","searchModule","detailsModule","errorModule","ngRoute"]);a.config(["$routeProvider",function(a){a.when("/",{redirectTo:"/list"}).when("/home",{redirectTo:"/list"}).when("/list",{templateUrl:"partials/list.html",controller:"ListController",controllerAs:"ctrl"}).when("/map",{templateUrl:"partials/map.html",controller:"MapController"}).when("/details/:number",{templateUrl:"partials/details.html",controller:"DetailsController",controllerAs:"ctrl"}).when("/search",{templateUrl:"partials/search.html",controller:"SearchController"}).when("/timetable",{templateUrl:"partials/timetable.html"}).when("/about",{templateUrl:"partials/about.html"}).when("/error",{templateUrl:"partials/error.html",controller:"ErrorController",controllerAs:"ctrl"}).otherwise({redirectTo:"/error"})}]),a.run(["$rootScope","$window","$location","DataService",function(a,b,c,d){window.addEventListener("load",function(a){window.applicationCache.addEventListener("updateready",function(a){window.applicationCache.status==window.applicationCache.UPDATEREADY&&confirm("Ãˆ disponibile una nuova versione di Ports. Vuoi caricarla ora?")&&window.location.reload()},!1)},!1),a.$on("$viewContentLoaded",function(){b.ga("send","pageview",{page:c.path()})}),a.loading=!0,a.rooms=[],d.retrieve().then(function(b){a.rooms=b.data,a.queryDate=b.queryDate,a.currentDate=b.currentDate},function(b){a.error=!0,window.location.href="#/error"})["finally"](function(){a.loading=!1})}]),a.directive("legend",function(){return{restrict:"E",templateUrl:"../partials/legend.html",replace:!0}})}(),$(document).ready(function(){var a='<img src="/img/navbar_icons/minimizedNavbar.png">',b='<img src="/img/navbar_icons/reverseMinNav.png">',c=!0;$(".hamburger").click(function(){$(".hamburger").empty(),c?($(".hamburger").append(b),c=!1,$(".mobileMenu").removeClass("hide")):($(".hamburger").append(a),c=!0,$(".mobileMenu").addClass("hide"))})}),$(document).ready(function(){var a=function(a,b){$(a).find("div").css("color",b)},b=function(a,b,c){var d=$(a).find("img").attr("src"),e=d.replace(b,c);$(a).find("img").attr("src",e)};$(".navelenco").hover(function(){a(".navelenco","white"),b(".navelenco","default","mono_white")},function(){a(".navelenco","black"),b(".navelenco","mono_white","default")}),$(".navmappa").hover(function(){a(".navmappa","white"),b(".navmappa","default","mono_white")},function(){a(".navmappa","black"),b(".navmappa","mono_white","default")}),$(".navcerca").hover(function(){a(".navcerca","white"),b(".navcerca","default","mono_white")},function(){a(".navcerca","black"),b(".navcerca","mono_white","default")}),$(".navorari").hover(function(){a(".navorari","white"),b(".navorari","default","mono_white")},function(){a(".navorari","black"),b(".navorari","mono_white","default")})}),$(function(){$("a[href*=#]:not([href=#])").click(function(){if(location.pathname.replace(/^\//,"")==this.pathname.replace(/^\//,"")&&location.hostname==this.hostname){var a=$(this.hash);if(a=a.length?a:$("[name="+this.hash.slice(1)+"]"),a.length)return $("html,body").animate({scrollTop:a.offset().top},1e3),!1}})}),function(){angular.module("detailsModule",[]).controller("DetailsController",["$scope","$routeParams","$log","$location",function(a,b,c,d){var e=this;e.number=b.number;var f=function(){function b(a){var b="#"+e.room.number.toLowerCase(),c=a.select(b);c.attr("fill","#42A5F5"),j.append(a)}for(var c=void 0,f=0,g=a.rooms,h=g.length;h>f;f++)g[f].number==e.number&&(c=f);if(void 0==c)d.path("error");else{e.room=a.rooms[c],e.states=e.room.states;var i=null;if(e.heading=null,1===e.room.building?-1===e.room.floor?(i="../img/mappe/Povo1PT.svg",e.heading="Povo1 - Piano Terra"):0===e.room.floor&&(i="../img/mappe/Povo1P1.svg",e.heading="Povo1 - Primo Piano"):2===e.room.building&&(-1===e.room.floor?(i="../img/mappe/Povo2PT.svg",e.heading="Povo2 - Piano Terra"):0===e.room.floor&&(i="../img/mappe/Povo2P1.svg",e.heading="Povo2 - Primo Piano")),null!=i){var j=Snap("#map_detail");Snap.load(i,b)}}};a.loading?(c.debug("Data loadng..."),a.$watch("loading",function(a,b){!a&&b&&(c.info("Data loaded!"),f())})):(c.info("Data already loaded..."),f())}])}(),function(){"use strict";angular.module("errorModule",[]).controller("ErrorController",["$location",function(a){this.redirect=function(){a.path("/")}}])}(),function(){"use strict";angular.module("listModule",["serviceModule"]).controller("ListController",["$scope",function(a){this.isFree=function(a){return 0!==a.availability},this.order="availability",this.reverse=!0,this.setOrder=function(a){this.order===a?this.reverse=!this.reverse:(this.reverse=!1,this.order=a)}}])}(),function(){var a="#66BB6A",b="#66BB6A",c="orange",d="#FFCA28",e="#EF5350",f="#42A5F5",g=null;angular.module("mapModule",[]).controller("MapController",["$scope","$log",function(h,i){function j(h,i){for(var j=0,k=i.length;k>j;j++){var l=i[j].number,m="#"+l.toLowerCase(),n=h.select(m),o=null;if(null!=n){switch(i[j]["class"]){case"dark-green":o=a;break;case"green":o=b;break;case"orange":o=c;break;case"yellow":o=d;break;case"red":o=e}n.attr("fill",o),n.attr("cursor","pointer");var p=m+"t",q=h.select(p);o==b||o==e?q.attr("fill","white"):q.attr("fill","#lalala"),q.attr("cursor","pointer"),n.hover(function(){g=this.attr("fill"),this.attr("fill",f)},function(){this.attr("fill",g),g=null}),n.click(function(){var a=this.attr("id").toUpperCase();window.location="#/details/"+a}),q.click(function(){var a=this.attr("id").toUpperCase().substring(0,this.attr("id").length-1);location.href="#/details/"+a})}}}function k(a){var b=Snap("#SvgPovo1PT");Snap.load("../img/mappe/Povo1PT.svg",function(c){j(c,a),b.append(c)});var c=Snap("#SvgPovo1P1");Snap.load("../img/mappe/Povo1P1.svg",function(b){j(b,a),c.append(b)});var d=Snap("#SvgPovo2PT");Snap.load("../img/mappe/Povo2PT.svg",function(b){j(b,a),d.append(b)});var e=Snap("#SvgPovo2P1");Snap.load("../img/mappe/Povo2P1.svg",function(b){j(b,a),e.append(b)})}h.loading?(i.info("Data loadng..."),h.$watch("loading",function(a,b){!a&&b&&(i.info("Data loaded!"),k(h.rooms))})):(i.info("Data already loaded..."),k(h.rooms))}])}(),function(){"use strict";var a=angular.module("searchModule",[]);a.filter("myfilter",function(){return function(a,b,c,d,e){for(var f=[],g=0,h=a.length;h>g;g++){var i=a[g];(i.power==e||"all"==e)&&!(i.building!=b&&"all"!=b||i.floor!=c&&"all"!=c||void 0!=d&&"all"!=d&&i.number!=d||!f.push(i))}return f}}),a.controller("SearchController",["$scope","$log",function(a,b){a.error&&(window.location.href="/#/error"),a.roomNumbers=["A101","A102","A103","A104","TODO","waiting for teo's JSON"],a.order="availability",a.reverse=!0,a.building="all",a.floor="all",a.power=!0,a.selectBuilding=function(b){a.building=b},a.selectFloor=function(b){a.floor=b},a.selectPower=function(b){a.power=b};var c=function(){b.warn("Elaborate"),b.warn(a.rooms),a.roomNumbers=[];for(var c=0,d=a.rooms.length;d>c;c++)a.roomNumbers.push(a.rooms[c].number)};a.loading?(b.warn("Data loadng... WAIT!"),a.$watch("loading",function(a,d){!a&&d&&(b.info("Data loaded!"),c())})):(b.info("Data already loaded..."),c())}])}(),function(){"use strict";var a=angular.module("serviceModule",[]);a.service("DataService",["$q","$http","$log",function(a,b,c){this.retrieve=function(){var d=new Date,e=new Date(d);DateUtilities.nextOpenDay(e);var f=e.getTime(),g="http://api.trentoleaf.tk/app?time=",h=[],i=[{room:"A101",power:!0,type:"normal",places:200},{room:"A102",power:!0,type:"normal",places:160},{room:"A103",power:!0,type:"normal",places:160},{room:"A104",power:!0,type:"normal",places:160},{room:"A105",power:!0,type:"normal",places:160},{room:"A106",power:!0,type:"normal",places:160},{room:"A107",power:!0,type:"normal",places:70},{room:"A108",power:!0,type:"normal",places:70},{room:"A201",power:!0,type:"pc",places:56},{room:"A202",power:!0,type:"pc",places:56},{room:"A203",power:!0,type:"normal",places:70},{room:"A204",power:!0,type:"normal",places:87},{room:"A205",power:!0,type:"normal",places:87},{room:"A206",power:!0,type:"normal",places:126},{room:"A207",power:!0,type:"normal",places:110},{room:"A208",power:!0,type:"normal",places:90},{room:"A209",power:!0,type:"normal",places:55},{room:"A210",power:!0,type:"normal",places:70},{room:"A211",power:!0,type:"normal",places:35},{room:"A212",power:!0,type:"normal",places:55},{room:"A213",power:!0,type:"normal",places:33},{room:"A214",power:!0,type:"normal",places:33},{room:"A215",power:!1,type:"normal",places:33},{room:"A216",power:!1,type:"multipurpose",places:35},{room:"A217",power:!1,type:"multipurpose",places:35},{room:"A218",power:!1,type:"normal",places:33},{room:"A219",power:!0,type:"normal",places:33},{room:"A220",power:!0,type:"normal",places:33},{room:"A221",power:!0,type:"normal",places:55},{room:"A222",power:!0,type:"normal",places:70},{room:"A223",power:!0,type:"normal",places:35},{room:"A224",power:!0,type:"normal",places:55},{room:"B101",power:!1,type:"normal",places:80},{room:"B102",power:!1,type:"normal",places:80},{room:"B103",power:!1,type:"normal",places:80},{room:"B104",power:!1,type:"normal",places:80},{room:"B105",power:!1,type:"normal",places:80},{room:"B106",power:!0,type:"pc",places:130},{room:"B107",power:!1,type:"normal",places:180}],j=a.defer(),k=b.get(g+f,{cache:!0});return k.success(function(a){c.debug("result"),c.debug(a),c.debug("extras"),c.debug(i);for(var b=0,f=i.length;f>b;b++){var g=new Room(i[b].room);g.setExtras(i[b]),g.states=a[g.number.toLowerCase()],g.calculateAvaiability(e,d),g.setFree(13),h.push(g)}c.debug("data"),c.debug(h),j.resolve({data:h,queryDate:e,currentDate:d})}),k.error(function(a){c.warn(a),j.reject("API error...")}),j.promise}}])}(),DateUtilities={OPEN:8,CLOSE:20,addDay:function(a,b){a.setHours(a.getHours()+24*b)},roundToFollowingHalfHour:function(a){a.setMilliseconds(0),a.setSeconds(0),a.getMinutes()<30&&a.setMinutes(30),a.getMinutes()>30&&(a.setMinutes(30),a.setHours(a.getHours()+1))},nextOpenDay:function(a){a.getHours()>=this.CLOSE&&this.addDay(a,1),a.setMilliseconds(0),a.setSeconds(0),a.setMinutes(30),a.setHours(7)}},String.prototype.contains=function(a){return-1!=this.indexOf(a)};var Room=function(a){this.number=a+"",this.building=this.number.contains("A")?1:2,this.floor="B106"==this.number||"B107"==this.number?0:this.number.slice(1)<200?-1:0,this.availability=0,this.states=[]};Room.prototype.calculateAvaiability=function(a,b){if(0==this.states.length)throw"Please set variable 'states' before calling this method";var c=0;a.getTime()<b.getTime()&&(c=b.getHours()-a.getHours());for(var d=c;d<this.states.length&&this.states[d];d++)this.availability+=1;switch(this.availability){case 0:this["class"]="red";break;case 1:case 2:this["class"]="orange";break;case 3:case 4:this["class"]="yellow";break;case 5:case 6:this["class"]="green";break;default:this["class"]="dark-green"}},Room.prototype.setFree=function(a){this.free=this.availability==a},Room.prototype.setExtras=function(a){this.type=a.type,this.power=a.power,this.places=a.places,this.size=this.places<=40?"tiny":this.places<=55?"small":this.places<=90?"middle":this.places<=160?"big":"huge",this.card=2==this.building};
//# sourceMappingURL=combined.min.js.map
